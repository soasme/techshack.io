<!DOCTYPE html>
<html lang="en">
<head>
    <title>Techshack Weekly - 安全使用 Linux 服务器</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" />
        <link rel="stylesheet" href="https://www.soasme.com/techshack.weekly/theme/css/main.css" type="text/css" />
        <link href="https://www.soasme.com/techshack.weekly/" type="application/atom+xml" rel="alternate" title="Techshack Weekly ATOM Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://www.soasme.com/techshack.weekly/css/ie.css"/>
                <script src="https://www.soasme.com/techshack.weekly/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://www.soasme.com/techshack.weekly/css/ie6.css"/><![endif]-->

</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-lg-2"></div>
            <div id="content" class="col-lg-6">
                <div class="entry">
<section id="content" class="body">
  <header>
    <h2 class="entry-title">安全使用 Linux 服务器</h2>
  </header>
  <div class="entry-content">
        <p><a href="https://medium.com/@ageis/common-approaches-to-securing-linux-servers-and-what-runs-on-them-dadcacc5388b">查看原文</a></p>
<p>为了打造安全的系统，我们需要考虑的东西有方方面面。本文介绍了一份安全检查的清单。</p>
<ul>
<li>访问控制列表 (ACLs): 系统架构必须按组和角色授权访问系统的不同部分。Linux 相关的命令：acl</li>
<li>系统审计：用户登录机器，必须能够做到审计用户执行的所有命令。Linux 相关命令：auditd / go-audit</li>
<li>静态分析：内存安全要用工具来保障，代码要审计，静态分析，甚至被 fuzzed。可以用各种静态分析的工具来做，甚至用 Rust 这种语言写。</li>
<li>网络分区：服务器妥善地放在负载均衡后面。如果网络挂掉或者没有路由，这些主机应该可以存活。配置 VPN，给机器配置内网和公网地址。iptables, ufw.</li>
<li>Compartmentalization: 让员工将他们的电脑去分开工作和非工作的部分。工具可以是虚拟机：Qubes / VirtualBox.</li>
<li>文件权限和 umask: 妥善设置好每个配置文件的 r, w, x.</li>
<li>容器：确认谁有权限构建和推送镜像到生产环境。这些要被签名，验证，为安全补丁和 CVEs 做监控。</li>
<li>Utilizing threat intelligence：订阅 Thread Intelligence。对于一些邪恶混乱的 IP，主动封禁。 Github hslatman/awesome-threat-intelligence</li>
<li>防火墙 / packet 过滤器：审计防火墙规则，跑测试脚本，确保机器只和需要通信的机器通信。工具：pfSense, OPNsense.</li>
<li>DNS：锁定 DNS 变更。变更时得到通知。启动 DNSSEC。Namecheap 适合注册，Cloudflare 适合做 DNS。</li>
<li>物理访问：如果数据中心里有人偷偷看，会看到服务器上的东西么？服务器退休，数据会被抹干净么？</li>
<li>deterministic builds：Gitian</li>
<li>使用数字签名：GnuPG</li>
<li>程序跑在 sandbox 里面，无法得到外部的系统调用和权限访问。</li>
<li>传输层加密：TLS，可以用 Let‘s Encrypt。不用诸如 MD5，SHA1，RC4 等不再安全的算法，而应该用更安全的 ciphers，HMACs 以及更合适的 key exchange 算法。使用椭圆曲线，不使用 RSA。调整 OpenSSH，GnuPG，OpenVPN 的配置，因为默认的都不够安全。</li>
<li>Key / Secrets 管理。服务器上的 Key 可以用 GPGSync，sops，Vault 管理。版本控制里面千万别有密钥。</li>
<li>HTTP 的 Security Headers：X-Frame-Options，X-XSS-Protection 等等</li>
<li>用工具确保文件没有被篡改过，并会就变更生成告警。</li>
<li>升级内核，堵住诸如 Spectre 和 Meltdown 这样漏洞。</li>
<li>如果一些设备没有用上，那么内核中那些 modules 就关掉。</li>
<li>分析系统日志。使用 Filebeat / rsyslog / Logstash 这样的工具。</li>
<li>资源使用量监控：Metricbeat，Prometheus，Nagios，Osquery</li>
<li>测试架构：Serverspec，Testinfra</li>
<li>平台安全测试：使用 CHIPSEC 工具测试 BIOS 和其它 low-level 的接口。</li>
<li>sshd：关闭 root login，使用 key 登录，防止 brute force 登录。换一个监听端口迟早还会被扫出来。将 sshd 藏在 vpn 后面，或者通过 Tor hidden service 授权，或者需要 port-knocking </li>
<li>Nginx server_tokens off, Apache ServerSignature off。尽可能少地泄漏版本信息。</li>
<li>二步验证：YubiKey。</li>
<li>Quad9 提供了 Google public DNS / OpenDNS 的替代方案，但是可以帮忙挡掉访问有害域名。可以将 nameserver 设置成 9.9.9.9, 相当于 Chrome Safe Browsing，但是是在 DNS 这一层做。</li>
<li>审计可信任的组织：根证书及时更新，移除掉过期的第三方。</li>
<li>Git commits 用 GPG 做签名。</li>
</ul>

  </div><!-- /.entry-content -->
</section>
                </div>

                <hr>
                <div id="footer" class="col-lg-12">
                    <nav>
                        <ul>
                        </ul>
                    </nav>
                </div>
            </div>
            <div id="sidebar" class="col-lg-4">
                <h1>
                    <a href="https://www.soasme.com/techshack.weekly " title="Techshack Weekly">
                        <img src="https://www.soasme.com/techshack.weekly/images/logo-200x50.png" />
                    </a>
                </h1>
                <span class="description"> </span>
                <div><div class="entry-subscription">
    <h5>Techshack Weekly</h5>
    <br>
    专注于后端技术阅读
    <br>
    目前有上百位订阅者。
    <br>
    订阅 <a href="https://www.soasme.com/techshack.weekly/feeds/issues.atom.xml">RSS</a>
    <br>
    欢迎加入 <a href="https://t.me/techshack">Telegram Channel</a> ，
    <br>
    <iframe src="https://tgwidget.com/widget/count/?id=5a66b26483ba88e7118b4568" frameborder="0" scrolling="no" horizontalscrolling="no" verticalscrolling="no" width="160px" height="50px" async></iframe>
    <br>
    关注推特 <a href="https://twitter.com/techshackweekly">@techshackweekly</a>。
    <br>
    <a href="https://twitter.com/TechshackWeekly?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @TechshackWeekly</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <hr>
</div></div>
                <div><!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
    #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif;  width:250px;}
    /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
       We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="https://soasme.us17.list-manage.com/subscribe/post?u=617c1cb80ba1b0cbf828df387&amp;id=10442a8ee6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
    <label for="mce-EMAIL">Subscribe to our mailing list</label>
    <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_617c1cb80ba1b0cbf828df387_10442a8ee6" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>

<!--End mc_embed_signup--></div>
                    <div>:: <a href="https://www.soasme.com/techshack.weekly/categories.html">Categories</a></div>
                <!-- <span class="feed"><a href="">RSS</a> | <a href="">Atom</a></span> -->
            </div>
            <div class="col-lg-2"></div>
        </div>
    </div>
    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-36183732-2");
    pageTracker._trackPageview();
    } catch(err) {}</script>
</body>
</html>