<!DOCTYPE html>
<html lang="en">
<head>
    <title>Techshack Weekly - Netflix 点击按钮的背后</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" />
        <link rel="stylesheet" href="https://www.soasme.com/techshack.weekly/theme/css/main.css" type="text/css" />
        <link href="https://www.soasme.com/techshack.weekly/" type="application/atom+xml" rel="alternate" title="Techshack Weekly ATOM Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://www.soasme.com/techshack.weekly/css/ie.css"/>
                <script src="https://www.soasme.com/techshack.weekly/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://www.soasme.com/techshack.weekly/css/ie6.css"/><![endif]-->

</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-lg-2"></div>
            <div id="content" class="col-lg-6">
                <div class="entry">
<section id="content" class="body">
  <header>
    <h2 class="entry-title">Netflix 点击按钮的背后</h2>
  </header>
  <div class="entry-content">
        <p><a href="http://highscalability.com/blog/2017/12/11/netflix-what-happens-when-you-press-play.html">查看原文</a></p>
<p>本文介绍了 Netflix 作为视频网站背后所涉及的客户端，服务端，网络等等相关的技术。</p>
<ul>
<li>一个看起来很简单的网站，在用户量级上去后就会变的非常有挑战。</li>
<li>Netflix 工程博客记录了很多他们的技术架构文章。</li>
<li>Netflix 使用混合云：AWS + Open Connect</li>
<li>Netflix 的三大核心组件：客户端，服务端，CDN</li>
<li>Netflix 跟 EC2 发布在同一年，所以那时候还得自搭数据中心。自建 DC 的问题主要就是效率特低。</li>
<li>2008 年出过一次大事故，比起维护一个数据中心，工程师们觉得还是维护产品更重要更简单，所以全线切去 AWS。历经八九年经营，现在使用着上千台 EC2 实例。</li>
<li>Netflix 需要比 AWS 更稳定，通过在 North Virginia，Oregon，Dublin 三地搭服务，可以做到某地出问题了就切流量去别的。作为客户端，甚至可能都不会意识到后端某地发生了故障。Netflix 每个月也都会出一次演练 aws 挂了，整个集群可以在六分钟内切走。关于这方面，Netflix 可以说在业内做的比较领先。</li>
<li>S3 存储着视频数据，EC2 则是获取视频元数据的入口点。</li>
<li>Netflix 使用 DynamoDB &amp; Cassandra 作为分布式数据库，另有一系列配套的数据分析流水线计算诸如推荐等数据。</li>
<li>作为视频播放领域的特定问题，服务端转码是指服务器会为客户端预先转码好最适合特定设备的编码视频。这些转码需要耗费很多 CPU 资源。Netflix 从上游内容供应方（video source media）那里获得数据，然后校验颜色，掉帧等情况，然后切成 chunk 分批处理，最后重新合并所有 chunk，再次校验成功才推送到 CDN，全程大约需要 30 分钟。</li>
<li>目前 Netflix 支持大约 2200 种不同的设备，例如 iPhone，XBox，Wii，Kindle，AppleTV，等等。这些优化的视频会针对网速，播放质量等做适配。</li>
<li>Netflix 自建 CDN 以满足自己变态的需求。每个存储视频资源的地方都叫 PoP（Point of present）。大 CDN 提供方诸如 Akamai 什么的不能满足他们的需求，例如切换到另外一个 PoP 以换取别的资源。基于 AWS 的技术经过很多工程师的运营已经足够了本钱，所以自己造更好。他们使用 Open Connect 建 CDN。</li>
<li>建 CDN 不需要数据中心，只要找遍布全世界的 IXPs。（IXP 就是网络互联的节点）</li>
</ul>

  </div><!-- /.entry-content -->
</section>
                </div>

                <hr>
                <div id="footer" class="col-lg-12">
                    <nav>
                        <ul>
                        </ul>
                    </nav>
                </div>
            </div>
            <div id="sidebar" class="col-lg-4">
                <h1>
                    <a href="https://www.soasme.com/techshack.weekly " title="Techshack Weekly">
                        <img src="https://www.soasme.com/techshack.weekly/images/logo-200x50.png" />
                    </a>
                </h1>
                <span class="description"> </span>
                <div><div class="entry-subscription">
    <h5>Techshack Weekly</h5>
    <br>
    专注于后端技术阅读
    <br>
    目前有上百位订阅者。
    <br>
    订阅 <a href="https://www.soasme.com/techshack.weekly/feeds/issues.atom.xml">RSS</a>
    <br>
    欢迎加入 <a href="https://t.me/techshack">Telegram Channel</a> ，
    <br>
    <iframe src="https://tgwidget.com/widget/count/?id=5a66b26483ba88e7118b4568" frameborder="0" scrolling="no" horizontalscrolling="no" verticalscrolling="no" width="160px" height="50px" async></iframe>
    <br>
    关注推特 <a href="https://twitter.com/techshackweekly">@techshackweekly</a>。
    <br>
    <a href="https://twitter.com/TechshackWeekly?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @TechshackWeekly</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <hr>
</div></div>
                <div><!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
    #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif;  width:250px;}
    /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
       We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="https://soasme.us17.list-manage.com/subscribe/post?u=617c1cb80ba1b0cbf828df387&amp;id=10442a8ee6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
    <label for="mce-EMAIL">Subscribe to our mailing list</label>
    <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_617c1cb80ba1b0cbf828df387_10442a8ee6" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>

<!--End mc_embed_signup--></div>
                    <div>:: <a href="https://www.soasme.com/techshack.weekly/categories.html">Categories</a></div>
                <!-- <span class="feed"><a href="">RSS</a> | <a href="">Atom</a></span> -->
            </div>
            <div class="col-lg-2"></div>
        </div>
    </div>
    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-36183732-2");
    pageTracker._trackPageview();
    } catch(err) {}</script>
</body>
</html>