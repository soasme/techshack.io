<!DOCTYPE html>
<html lang="en">
<head>
    <title>Techshack Weekly - Makefile Basics</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" />
        <link rel="stylesheet" href="https://www.soasme.com/techshack.weekly/theme/css/main.css" type="text/css" />
        <link href="https://www.soasme.com/techshack.weekly/" type="application/atom+xml" rel="alternate" title="Techshack Weekly ATOM Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://www.soasme.com/techshack.weekly/css/ie.css"/>
                <script src="https://www.soasme.com/techshack.weekly/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://www.soasme.com/techshack.weekly/css/ie6.css"/><![endif]-->

</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-lg-2"></div>
            <div id="content" class="col-lg-6">
                <div class="entry">
<section id="content" class="body">
  <header>
    <h2 class="entry-title">Makefile Basics</h2>
  </header>
  <div class="entry-content">
        <p><a href="https://gist.github.com/isaacs/62a2d1825d04437c6f08">查看原文</a></p>
<p>这段代码是 isaacs 的一段 gist，可以学到 make 的最基本知识，而关于更多的知识，可查看 gnu make man：http://www.gnu.org/software/make/manual/make.html</p>
<ul>
<li><code>make -f &lt;filename&gt;</code> 可以指定运行哪个 Makefile，默认使用 <code>./Makefile</code></li>
<li>语法如下，target 是必须的，依赖和命令是可选的</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="err">&lt;target&gt;: &lt;prerequiresites&gt;...</span>
<span class="err">    &lt;commands&gt;</span>
</code></pre></div>


<ul>
<li><code>@</code> 加在命令前面不输出命令</li>
<li>多条 <code>&lt;commands</code> 之间不会互相共享环境变量</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c">var-lost:</span>
<span class="c">    export foo=bar</span>
<span class="c">    echo &quot;foo=[$$foo]&quot; # 这里 $foo 不会被赋值上 bar，因为上下是隔离的环境</span>
</code></pre></div>


<ul>
<li>共享的方法是写到一行去</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c">var-kept:</span>
<span class="c">    export foo=bar; \</span>
<span class="c">    echo &quot;foo=[$$foo]&quot;</span>
</code></pre></div>


<ul>
<li>依赖可以是文件名，target 只会在所有依赖有变动的时候才会运行。例如 <code>source.txt</code> 是依赖，如果文件时间戳没变，依赖它的 target 就不会被运行</li>
<li>每个文件都写依赖不现实，可以在 commands 中用 <code>$@</code> 表示当前 target, <code>$&lt;</code> 表示第一个依赖 target, <code>$^</code> 表示所有依赖 targets，<code>$?</code> 表示更新的依赖列表，<code>$$</code> 是 $ 的转义，<code>$*</code> 是 % 的引用。</li>
<li><code>.PHONY</code> 依赖所有文件</li>
</ul>

  </div><!-- /.entry-content -->
</section>
                </div>

                <hr>
                <div id="footer" class="col-lg-12">
                    <nav>
                        <ul>
                        </ul>
                    </nav>
                </div>
            </div>
            <div id="sidebar" class="col-lg-4">
                <h1>
                    <a href="https://www.soasme.com/techshack.weekly " title="Techshack Weekly">
                        <img src="https://www.soasme.com/techshack.weekly/images/logo-200x50.png" />
                    </a>
                </h1>
                <span class="description"> </span>
                <div><div class="entry-subscription">
    <h5>Techshack Weekly</h5>
    <br>
    专注于后端技术阅读
    <br>
    目前有上百位订阅者。
    <br>
    订阅 <a href="https://www.soasme.com/techshack.weekly/feeds/issues.atom.xml">RSS</a>
    <br>
    欢迎加入 <a href="https://t.me/techshack">Telegram Channel</a> ，
    <br>
    <iframe src="https://tgwidget.com/widget/count/?id=5a66b26483ba88e7118b4568" frameborder="0" scrolling="no" horizontalscrolling="no" verticalscrolling="no" width="160px" height="50px" async></iframe>
    <br>
    关注推特 <a href="https://twitter.com/techshackweekly">@techshackweekly</a>。
    <br>
    <a href="https://twitter.com/TechshackWeekly?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @TechshackWeekly</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <hr>
</div></div>
                <div><!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
    #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif;  width:250px;}
    /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
       We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="https://soasme.us17.list-manage.com/subscribe/post?u=617c1cb80ba1b0cbf828df387&amp;id=10442a8ee6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
    <label for="mce-EMAIL">Subscribe to our mailing list</label>
    <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_617c1cb80ba1b0cbf828df387_10442a8ee6" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>

<!--End mc_embed_signup--></div>
                    <div>:: <a href="https://www.soasme.com/techshack.weekly/categories.html">Categories</a></div>
                <!-- <span class="feed"><a href="">RSS</a> | <a href="">Atom</a></span> -->
            </div>
            <div class="col-lg-2"></div>
        </div>
    </div>
    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-36183732-2");
    pageTracker._trackPageview();
    } catch(err) {}</script>
</body>
</html>