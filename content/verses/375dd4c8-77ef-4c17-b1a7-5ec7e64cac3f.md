Title: 使用 SO_REUSEPORT 可以重用端口
Date: 2017-11-11 00:00
Modified: 2017-11-11 00:00
Slug: verses/375dd4c8-77ef-4c17-b1a7-5ec7e64cac3f
Category: verses
Authors: Ju Lin
verse_category: Unix

[查看原文](https://speakerdeck.com/joewalnes/linux-port-sharding)

Linux 在 3.9 以后可以使用 SO_REUSEPORT 重用端口。这个选项可以在新建 socket 时候用 setsocketopt 设定。设定之后，多个进程可以一起监听同一个端口。不设定的话，会抛出端口 Conflict 的错误。这个功能特别适合用于处理滚动升级：版本1监听端口，上线版本2也监听这个端口，停掉版本1，完成上线。
