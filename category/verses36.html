<!DOCTYPE html>
<html lang="en">
<head>
    <title>Techshack Weekly </title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" />
        <link rel="stylesheet" href="https://www.soasme.com/techshack.weekly/theme/css/main.css" type="text/css" />
        <link href="https://www.soasme.com/techshack.weekly/" type="application/atom+xml" rel="alternate" title="Techshack Weekly ATOM Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://www.soasme.com/techshack.weekly/css/ie.css"/>
                <script src="https://www.soasme.com/techshack.weekly/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://www.soasme.com/techshack.weekly/css/ie6.css"/><![endif]-->

</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-lg-2"></div>
            <div id="content" class="col-lg-6">
                <div class="entry">
        
        

 
                <section id="content" class="body">
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/01bf2d86-38b1-4527-8a58-f9dfe2468a8b.html" rel="bookmark"
                                title="Permalink to Google Breakfix 项目 - Google 如何做基于事故的数据分析"
                                >Google Breakfix 项目 - Google 如何做基于事故的数据分析</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://www.usenix.org/conference/srecon16/program/presentation/lueder">查看原文</a></p>
<p>Chaos 意味着很多问题：事故又多糟糕，修好了么，日志什么样子，哪个客户受影响了，谁是相关的 oncall，等等等等。Google 为这类问题收集了几类数据用于分析，也写了一些工具生成 Postmortem 报告。这些数据主要包括：</p>
<ul>
<li>Timing Data：Start Time, Detection Time, End time, Escalation Time, Mitigation Time, 其中从 Hits Production 到 Detected 这段时间叫 TTD，从 Detected 到 Fully Resolved 这段时间叫 TTR，从 Hits Production 到 Fully Resolved 这段时间算作 Duration …</li></ul>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/01bf2d86-38b1-4527-8a58-f9dfe2468a8b.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/72dc3602-1b20-4b58-a781-3c60e1e81fab.html" rel="bookmark"
                                title="Permalink to The Clean Architecture"
                                >The Clean Architecture</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html">查看原文</a></p>
<p>IT 行业有不少带名字的架构方法论，例如 Hexagonal Architecture, Onion Architecture, Screaming Architecture, DCI, BCE；但纵使细节不同，总体是差不多的流程：相同的目标，不同的点拆开考虑，分层处理，层层相套，层中有商业逻辑，层间接口相通信。这些架构设计出来的系统也有相似的特征：独立运行，可测试，UI 方便调整，数据库可替换，外部依赖可替换，等等。</p>
<p>系统分层从里到外分别是业务逻辑，用例，控制层，外部接口层(UI, DB, Web, ...)。只能外层依赖内层，不能内层依赖外层。在代码里面，基本原则是外层代码里声明的东西，是不可以在内层代码里提及的，包括函数，类，变量，等等。类似的，外层使用的数据格式也不应该让内层使用。</p>
<p>Entities 封装了企业的 Business Rules …</p>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/72dc3602-1b20-4b58-a781-3c60e1e81fab.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/803d9866-b0e7-4cb9-bd6c-98dd933a50eb.html" rel="bookmark"
                                title="Permalink to 一份 Post-Mortem 报告中要有什么？"
                                >一份 Post-Mortem 报告中要有什么？</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://www.pagerduty.com/resources/learn/post-mortem-incident-report/">查看原文</a></p>
<p>Postmortem 是旨在从发生的事故中汲取经验的流程，它一般是一种基于事故的分析和讨论。系统变得复杂后，故障无法避免，评估和补救也需要跟进，而这些需要花时间去分析数据。很多 Post-Mortem 报告非常耗时，要跟不同团队沟通，找出信息拼在一起得出结论。Post-mortem 的产出可以有很多形式：Learning Review, After-Action Review, Incident Review, Incident Report, Post-Incident Review, Root Cause Analysis (RCA).</p>
<p>一份好的 Post-mortem 报告需要讲好故事，因此它需要包括：</p>
<ul>
<li>事件概览：什么服务/哪些客户收到了影响，Issue 有多久又多严重，谁在处理，以及到底最终怎么修复这个问题。</li>
<li>Root Cause Analysis：故障的根源是什么？究竟为什么会发生？</li>
<li>处理措施：当时如何诊断/评估的？哪些诊断是有用的？哪些诊断是有害的 …</li></ul>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/803d9866-b0e7-4cb9-bd6c-98dd933a50eb.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/eaac581b-daa1-453e-9ff7-e1119bbba127.html" rel="bookmark"
                                title="Permalink to How Complex Systems Fail"
                                >How Complex Systems Fail</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="http://web.mit.edu/2.75/resources/random/How Complex Systems Fail.pdf">查看原文</a></p>
<p>本文是 Chicago 大学的人写的关于 Failure 的小论文。</p>
<ul>
<li>复杂系统天生就是高风险的。</li>
<li>复杂系统设计上花了大量的功夫抵御故障。</li>
<li>灾难往往源于多点同时失效。</li>
<li>复杂系统总是潜伏着各种混合的故障</li>
<li>复杂系统可以被降级运行</li>
<li>灾难总是藏在角落。</li>
<li>事故后的分析其实没有一个 Root Cause，它肯定是多个地方同时失效连成串。</li>
<li>事后评估总觉得故障其实很容易避免，这种事后诸葛亮要不得。</li>
<li>人啊，即制造故障，也抵御故障。</li>
<li>程序员们都在赌事故不会发生（尽管时候看起来这些事故完全无法避免</li>
<li>系统模糊的一些边界行为只有在事故后才会被解决（这些模糊的地方其实本来就没人说清楚过</li>
<li>程序员们是复杂系统的一颗螺丝钉</li>
<li>复杂系统中的专家，过段时间就会需要另外一批（因为技术也在升级</li>
<li>变更会引入新的故障。</li>
<li>事后补救往往增加了系统复杂度，并引入了潜藏的风险。</li>
<li>安全必须是系统必须满足的特征，而非要去实现的组件。</li>
<li>人类会让系统越来越安全</li>
<li>不产生故障的操作往往需要有应对很多故障的经验</li>
</ul>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/eaac581b-daa1-453e-9ff7-e1119bbba127.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/26b9e65a-26f9-42d6-8e7d-b824b7191735.html" rel="bookmark"
                                title="Permalink to 发生多少次上下文切换算是正常？"
                                >发生多少次上下文切换算是正常？</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://serverfault.com/questions/14199/how-many-context-switches-is-normal-as-a-function-of-cpu-cores-or-other">查看原文</a></p>
<p>发生多少次上下文切换非常取决于你所运行的程序。一般来说如果程序有很多系统调用（syscall），那么很有可能上下文切换的量会很高；如果大部分程序都只是空闲等待 socket，那上下文切换就会相对少一些。</p>
<p>系统调用是一定会造成 context switches 的，因为内核需要从用户态转到内核态，然后再回到用户态。另外，也有可能你的很多进程都在进行 CPU 密集运算，每个进程被分到的 CPU 时间分片都不够执行，也会造成上下文切换增加，这个比率 = processes/core。</p>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/26b9e65a-26f9-42d6-8e7d-b824b7191735.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/26f6fdaa-8585-4616-bd43-a10ca7bb492e.html" rel="bookmark"
                                title="Permalink to 上下文切换(Context Switch) 介绍"
                                >上下文切换(Context Switch) 介绍</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="http://www.linfo.org/context_switch.html">查看原文</a></p>
<p>上下文切换也叫进程切换，或者任务切换，指的是 CPU 从一个进程或线程切换去执行另外一个。上下文切换只会发生在内核态中。上下文(context) 指的是 CPU 寄存器数据和 Program Counter。我们知道寄存器是 CPU 内部的可以超级快速存取数据的一个硬件，不过能存储的数据量很小。PC 则是一个特殊的寄存器，存储的是当前 CPU 运行到的具体指令序列的地址。发生上下文切换的时候，具体的行为有：</p>
<ol>
<li>进程执行 suspend, 上下文被暂时存在内存中</li>
<li>从内存中取出下一个执行的进程的上下文，恢复到 CPU 寄存器上</li>
<li>根据刚恢复的 PC 继续执行指令序列，即执行下一个进程。</li>
</ol>
<p>上下文切换是操作系统实现多任务的基石。即使 CPU 只有单核，操作系统依然可以实现多任务，靠得就是切分 CPU 时间片，再加进程数据暂存和恢复。尽管有硬件级别的上下文切换，大多数现代操作系统提供的还是软件上下文切换，这样可以使操作系统运行在任何 CPU 上 …</p>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/26f6fdaa-8585-4616-bd43-a10ca7bb492e.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/7fb422c5-be61-45db-b018-07aac143d9d8.html" rel="bookmark"
                                title="Permalink to 开开心心迁移到 Python3"
                                >开开心心迁移到 Python3</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://github.com/arogozhnikov/python3_with_pleasure">查看原文</a></p>
<p>本文介绍了不少 Python 3 的好用的特性。</p>
<p>pathlib 的 / 操作可以避免 os.path.join 的调用：</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="s1">&#39;path&#39;</span> <span class="o">/</span> <span class="s1">&#39;to&#39;</span> <span class="o">/</span> <span class="s1">&#39;file&#39;</span>
<span class="n">PosixPath</span><span class="p">(</span><span class="s1">&#39;/path/to/file&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/path/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;**/*.jpg&#39;</span><span class="p">)</span> <span class="c1"># 使用 glob 递归检测所有目录下的 jpg 图片</span>
</code></pre></div>


<p>Type hinting 可以帮助检测参数类型传错。可以用 <code>enforce</code> 这个库强制在运行时检查类型注解。</p>
<p>可以用 astropy 这个库单位转换：<code>frequency(speed=300_000 * u.km / u.s, wavelength …</code></p>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/7fb422c5-be61-45db-b018-07aac143d9d8.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/95126798-5e36-408b-9eac-d43e342d7006.html" rel="bookmark"
                                title="Permalink to 配置文件 rc 是什么意思"
                                >配置文件 rc 是什么意思</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://unix.stackexchange.com/questions/111611/what-does-the-rc-stand-for-in-etc-rc-d">查看原文</a></p>
<p>在 Unix 的早期，有个程序叫做 runcom，表示 run commands，缩写是 rc。这个程序，基本上就是早期的 sh，可以运行一个脚本里的一系列命令。不过后来大家就叫这个功能 shell，不叫它 runcom 了。现在 rc.d 指的是 runlevel, 不同的发行版功能不太一样，一般是运行操作系统的时候分别启动哪些组件。</p>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/95126798-5e36-408b-9eac-d43e342d7006.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/d0937023-aaa4-4ee0-a758-bd0c86f2d3c5.html" rel="bookmark"
                                title="Permalink to 配置文件 .d 是什么意思"
                                >配置文件 .d 是什么意思</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://unix.stackexchange.com/questions/4029/what-does-the-d-stand-for-in-directory-names">查看原文</a></p>
<p>后缀 <code>.d</code> 意思是 directory, 也就是目录。虽然 Unix 并不需要目录的名字上带个 .d 表示 <em>这是一个目录</em>, 但不少软件会有用这种风格，例如 init: <code>/etc/init.d</code>。这个风格现在被很多程序采用，用于组合分散的配置。来自 Debian mailing list 中的一个解释：如果见到了 .d 风格，很可能是在说这是一个目录，里面有很多零散的小配置，最终会被合并成为一个服务的配置。</p>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/d0937023-aaa4-4ee0-a758-bd0c86f2d3c5.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/ddefc7d8-cd4f-44e6-a314-f7f6cc62df18.html" rel="bookmark"
                                title="Permalink to 2010-2015 Instagram 的 五年，如何应对突发流量和宕机"
                                >2010-2015 Instagram 的 五年，如何应对突发流量和宕机</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://medium.com/backchannel/war-stories-3696d00207ff">查看原文</a></p>
<p>Instagram 上线第一天服务器资源仅相当于一台 Macbook Pro，但要 Serve  25000 个用户已经很吃力了。好在 IT 行业素来有分享实践的传统，偷师学艺，没几天就迁移到 AWS 上，用云服务买来了发展的时间。</p>
<p>Virginia 暴风肆虐导致 AWS us-east 机房断电，他们有一半的实例没电了。由于基本功没做，网站没法迅速搞起来，结果花了整整 36 个小时重建整个 infrastructure。经过这个事故，他们痛定思痛，去掉了脆弱的 bash 部署脚本，用上了成熟的 chef，另外采用 WAL-E 和 Postgres WAL shipping replication，并把整个后端运行在异地数据中心。</p>
<p>并入 F 家以后做了一次数据大迁移，相当于 100mph 高速运行的跑车逐个更换零件 …</p>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/ddefc7d8-cd4f-44e6-a314-f7f6cc62df18.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>

<p class="paginator">
        <a href="https://www.soasme.com/techshack.weekly/category/verses35.html">&laquo;</a>
    Page 36 / 54
        <a href="https://www.soasme.com/techshack.weekly/category/verses37.html">&raquo;</a>
</p>
            </section><!-- /#content -->

                </div>

                <hr>
                <div id="footer" class="col-lg-12">
                    <nav>
                        <ul>
                        </ul>
                    </nav>
                </div>
            </div>
            <div id="sidebar" class="col-lg-4">
                <h1>
                    <a href="https://www.soasme.com/techshack.weekly " title="Techshack Weekly">
                        <img src="https://www.soasme.com/techshack.weekly/images/logo-200x50.png" />
                    </a>
                </h1>
                <span class="description"> </span>
                <div><div class="entry-subscription">
    <h5>Techshack Weekly</h5>
    <br>
    专注于后端技术阅读
    <br>
    目前有上百位订阅者。
    <br>
    订阅 <a href="https://www.soasme.com/techshack.weekly/feeds/issues.atom.xml">RSS</a>
    <br>
    欢迎加入 <a href="https://t.me/techshack">Telegram Channel</a> ，
    <br>
    <iframe src="https://tgwidget.com/widget/count/?id=5a66b26483ba88e7118b4568" frameborder="0" scrolling="no" horizontalscrolling="no" verticalscrolling="no" width="160px" height="50px" async></iframe>
    <br>
    关注推特 <a href="https://twitter.com/techshackweekly">@techshackweekly</a>。
    <br>
    <a href="https://twitter.com/TechshackWeekly?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @TechshackWeekly</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <hr>
</div></div>
                <div><!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
    #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif;  width:250px;}
    /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
       We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="https://soasme.us17.list-manage.com/subscribe/post?u=617c1cb80ba1b0cbf828df387&amp;id=10442a8ee6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
    <label for="mce-EMAIL">Subscribe to our mailing list</label>
    <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_617c1cb80ba1b0cbf828df387_10442a8ee6" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>

<!--End mc_embed_signup--></div>
                    <div>:: <a href="https://www.soasme.com/techshack.weekly/categories.html">Categories</a></div>
                <!-- <span class="feed"><a href="">RSS</a> | <a href="">Atom</a></span> -->
            </div>
            <div class="col-lg-2"></div>
        </div>
    </div>
    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-36183732-2");
    pageTracker._trackPageview();
    } catch(err) {}</script>
</body>
</html>