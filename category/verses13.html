<!DOCTYPE html>
<html lang="en">
<head>
    <title>Techshack Weekly </title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" />
        <link rel="stylesheet" href="https://www.soasme.com/techshack.weekly/theme/css/main.css" type="text/css" />
        <link href="https://www.soasme.com/techshack.weekly/" type="application/atom+xml" rel="alternate" title="Techshack Weekly ATOM Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://www.soasme.com/techshack.weekly/css/ie.css"/>
                <script src="https://www.soasme.com/techshack.weekly/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://www.soasme.com/techshack.weekly/css/ie6.css"/><![endif]-->

</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-lg-2"></div>
            <div id="content" class="col-lg-6">
                <div class="entry">
        
        

 
                <section id="content" class="body">
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/8a564dec-e0e0-4ed7-bc03-637246dcd6b6.html" rel="bookmark"
                                title="Permalink to GLB - GitHub Open Source Load Balancer"
                                >GLB - GitHub Open Source Load Balancer</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://githubengineering.com/glb-director-open-source-load-balancer/">查看原文</a></p>
<p>本文是 GLB 开源的公告，在之前刚出 <a href="https://www.soasme.com/techshack.weekly/verses/9edd6773-ec0a-445a-ac4d-134a01fea9fb.html">Introduction</a> 的时候我也有做过介绍，这篇文章给出了更多实现细节上的介绍。它设计的目标是：做负载均衡，使用 ECMA 路由保持 L4 层的连接，使用 Rendezvous Hashing 将连接分配到 L7 层的服务。它跟 LVS 的区别在于，GLB Director 不存储所有的 flow states，而只存储部分（使用哈希分布），这样可以在节点移除时结束 flow。它扩展了 UDP 协议，自己封装了一套 packet。</p>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/8a564dec-e0e0-4ed7-bc03-637246dcd6b6.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/8d4ba4b7-86d0-469f-8b05-792d8767e4a4.html" rel="bookmark"
                                title="Permalink to TLS 1.3 正式发布"
                                >TLS 1.3 正式发布</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://blog.cloudflare.com/rfc-8446-aka-tls-1-3/amp/">查看原文</a></p>
<p>本文对 RFC 8446 (TLS 1.3) 做了概览。我们知道 HTTPS 中的 S 是 Secure Sockets Layer (SSL)。SSL 是个古老的词汇，现在其实大家都用 TLS 了。TLS 1.1 不安全，TLS 1.2 太慢，TLS 1.3 是未来（也是现在了）。TLS 是混合加密系统，使用非对称加密交换密钥，使用对称加密交换信息；前者慢，后者快。TLS 1.3 的主要目标是解决握手这块，也就是非对称加密交换密钥这块。以前的主流做法是 RSA, 缺点在于不是前向安全（可以被录制 …</p>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/8d4ba4b7-86d0-469f-8b05-792d8767e4a4.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/aaed260f-0bd9-4ddf-899f-ec6b250dc42f.html" rel="bookmark"
                                title="Permalink to 如何 Hack WebSockets"
                                >如何 Hack WebSockets</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://www.blackhillsinfosec.com/how-to-hack-websockets-and-socket-io/">查看原文</a></p>
<p>本文作者使用 Burp 对 WebSockets 应用做渗透测试。第一招是利用 Socket.io 的 HTTP Fallback 机制，让所有 WebSockets 请求降级到 HTTP 来测试，具体做法是拦截 socket.io 的响应，替换一行代码搞定。第二个方法是在 HTTP Upgrade WebSockets 的时候把代表 session 的 sid 录下来。</p>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/aaed260f-0bd9-4ddf-899f-ec6b250dc42f.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/3338f753-d582-4c69-9629-9f4eba644dd2.html" rel="bookmark"
                                title="Permalink to In Pursuit of Production Minimalism"
                                >In Pursuit of Production Minimalism</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://brandur.org/minimalism">查看原文</a></p>
<p>本文讲述了一个观点：生产环境应当尽可能简单，最小化。这可以认为是 KISS 原则的推论。作者列出了 Heroku 系统设计的一些实践：</p>
<ul>
<li>Heroku 管理所有用户数据库元信息的那个数据库，最后也变成了一个 Heroku Postgres -- 也变成了被管理的那个数据库。 // 尽管我觉得加剧了全部死翘翘的风险？</li>
<li>底层技术的革新，可以让我们丢掉整个上层产品，例如因为 SNI 的引入，可以直接丢掉 <code>ssl:ip</code>。</li>
<li>所有用 Scala 写的产品都废弃了，用尽可能少的语言写产品，系统更好维护，有更多人力可以维护。</li>
<li>合并一些 microservices，简化运维。</li>
</ul>
<p>总结起来，有以下这些基本点：</p>
<ul>
<li>废弃老技术</li>
<li>标准化，标准到一种数据库，一种语言，一种人物队列，一种webserver，一种反向代理。如果做不到，做到尽可能少。</li>
<li>系统中的啥东西都尽可能少。</li>
<li>刚发布的东西再观察观察。用那种发布了很多年的稳定软件。</li>
<li>能用别人写好的技术，尽可能不自己造车 …</li></ul>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/3338f753-d582-4c69-9629-9f4eba644dd2.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/03ccf478-8b50-4c08-9982-60d5496f1ae0.html" rel="bookmark"
                                title="Permalink to Cloudflare 优化 Nginx 性能"
                                >Cloudflare 优化 Nginx 性能</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://blog.cloudflare.com/how-we-scaled-nginx-and-saved-the-world-54-years-every-day/">查看原文</a></p>
<p>本文是 Cloudflare 的博客，关于如何让 Nginx 接收更多流量。</p>
<ul>
<li>Nginx 使用 event loops 解决 c10k 问题 (epoll_wait)</li>
<li><code>read(epoll_fd)</code> 如果遇到 EWOULDBLOCK 意味着 local read buffer 已经读完，Nginx 就停止从 socket 中读数据直到来更多数据。</li>
<li>由于 disk I/O 不同于 network I/O, 不存在等数据来这么一回事，直接 <code>read(epoll_fd)</code> 直到读完即可。<ul>
<li>如果场景是读取静态文件，完全可以去掉处理 network I/O 的逻辑。配上 SSD 硬盘 …</li></ul></li></ul>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/03ccf478-8b50-4c08-9982-60d5496f1ae0.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/0be928b4-1530-4746-8c9e-deea2d35b915.html" rel="bookmark"
                                title="Permalink to Kata Containers Paper"
                                >Kata Containers Paper</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://katacontainers.io/media/uploads/katacontainers/uploads/katacontainers/kata-containers-1pager.pdf">查看原文</a></p>
<p>Kata Containers 是一种区别于 runC, rkt, lxc 的容器技术，它混合了容器和虚拟化。后三种在单个 kernel 分配的 namespace 中启动容器。而 kata-containers 则是先开 lightweight hypervisor，分拆出多个虚拟机，再在每个虚拟机中运行 kernel 和容器。</p>
<p>优点：VM 比其他虚拟机技术更加轻量。使用场景：multi-tenanted applications.</p>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/0be928b4-1530-4746-8c9e-deea2d35b915.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/2cbae7d0-fbb0-44a1-8fdc-bd9b4282684c.html" rel="bookmark"
                                title="Permalink to 使用工程的方法寻找哈希函数"
                                >使用工程的方法寻找哈希函数</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://nullprogram.com/blog/2018/07/31/">查看原文</a></p>
<p>本文作者的任务是找到一个性能最好的 hash function。稍微学过 CS 的人都知道 hash function 接受参数，返回 int 哈希值。我们希望这个返回值尽可能不碰撞，变一点值就会造成大量的 output bits 位翻转。作者不同于学院派，使用的方法是遍历尽可能多的组合，给一个组合打分，找到最优解。这就是他给 uint32_t 参数做哈希找到的最优解</p>
<div class="highlight"><pre><span></span><code><span class="err">uint32_t</span>
<span class="err">prospector32(uint32_t x)</span>
<span class="err">{</span>
<span class="err">    x ^= x &gt;&gt; 15;</span>
<span class="err">    x *= UINT32_C(0x2c1b3c6d);</span>
<span class="err">    x ^= x &gt;&gt; 12;</span>
<span class="err">    x *= UINT32_C(0x297a2d39);</span>
<span class="err">    x ^= x &gt;&gt; 15;</span>
<span class="err">    return x;</span>
<span class="err">}</span>
</code></pre></div>


<p>他给 uint64_t 找到的解跟目前正在 SplitMix64 …</p>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/2cbae7d0-fbb0-44a1-8fdc-bd9b4282684c.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/0d846089-159a-474f-a703-b3220bff2437.html" rel="bookmark"
                                title="Permalink to Container best practices"
                                >Container best practices</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="http://docs.projectatomic.io/container-best-practices/">查看原文</a></p>
<p>本文对容器技术的实践做了不少总结，给出了一些最佳实践。</p>
<ul>
<li>multi stages: 删掉构建过程的文件</li>
<li>clean up: 删掉构建过程的文件</li>
<li>chaining method: 减少 image layer</li>
<li>cattle v/s pet containers: kill 后启动可以自动恢复健康的容器叫 cattle，否则是 pet。一般来说，数据库这种 container 算 pet containers。</li>
<li>容器配置要注意的一些坑： <code>/etc/localtime</code> <code>/etc/machine-id</code> 可以 mount 进容器。</li>
<li>容器内应用启动有三种方式：直接启动应用，使用脚本包一层，或者使用 systemd 启动程序。直接启动适合非服务类应用。脚本启动适合稍微复杂一点的程序。systemd 比较适合服务类应用，缺点是会让 image …</li></ul>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/0d846089-159a-474f-a703-b3220bff2437.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/741fb056-e088-4e59-823f-193a0b2e837f.html" rel="bookmark"
                                title="Permalink to Grafana Scripted Dashboards"
                                >Grafana Scripted Dashboards</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="http://docs.grafana.org/reference/scripting/">查看原文</a></p>
<p>Grafana 支持让你自己写 JavaScript 来生成监控面板，它适用的场景是你的面板老有一些动态的变量，这时候默认提供的静态 Json 定义的面板可能就不够用了。能够提供用代码解决的方案基本上可以解决任何问题。这个小功能尽管 API 并没有封装到很强大，但是在解决一些很 tricky 的问题的时候就显得不可或缺。</p>
<p>衍生思考：在框架级别的开发，我们首选根据 schema 提供默认功能，但也推荐提供类似 函数/脚本 等形式的接口，让一些事情可以让用户自己去定制。</p>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/741fb056-e088-4e59-823f-193a0b2e837f.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>


        

 
            <div>
                <article class="hentry">
                    <header>
                        <h3>
                            <a href="https://www.soasme.com/techshack.weekly/verses/98aac70d-68a8-46d5-8e0d-780d243d1675.html" rel="bookmark"
                                title="Permalink to Learn how to write a hash table in C"
                                >Learn how to write a hash table in C</a>
                        </h3>
                    </header>
                    <div class="entry-content">
                        <p><a href="https://github.com/jamesroutley/write-a-hash-table">查看原文</a></p>
<p>这个 Git 仓库教你如何用 C 实现 Open-addressed, double-hashed Hash table。涉及的话题包括：基本数据结构，哈希函数，哈希碰撞处理，增删改查，自动扩容缩容。我觉得从完成度来说，不输给教授数据结构的教材。</p>
<p>衍生思考：前一阵子在午休的时候花一个钟头从头实现了 <a href="https://github.com/soasme/linkedlist">linkedlist</a>, 从头实现标准数据结构带给人很强烈的满足感。相关的数据结构还有树，集合，图，推荐大家有空的时候去写一写，看看能否做到 bug-free。</p>
                        <a class="readmore" href="https://www.soasme.com/techshack.weekly/verses/98aac70d-68a8-46d5-8e0d-780d243d1675.html"
                            >read more</a>
                    </div><!-- /.entry-content -->
                </article>
            </div>

<p class="paginator">
        <a href="https://www.soasme.com/techshack.weekly/category/verses12.html">&laquo;</a>
    Page 13 / 54
        <a href="https://www.soasme.com/techshack.weekly/category/verses14.html">&raquo;</a>
</p>
            </section><!-- /#content -->

                </div>

                <hr>
                <div id="footer" class="col-lg-12">
                    <nav>
                        <ul>
                        </ul>
                    </nav>
                </div>
            </div>
            <div id="sidebar" class="col-lg-4">
                <h1>
                    <a href="https://www.soasme.com/techshack.weekly " title="Techshack Weekly">
                        <img src="https://www.soasme.com/techshack.weekly/images/logo-200x50.png" />
                    </a>
                </h1>
                <span class="description"> </span>
                <div><div class="entry-subscription">
    <h5>Techshack Weekly</h5>
    <br>
    专注于后端技术阅读
    <br>
    目前有上百位订阅者。
    <br>
    订阅 <a href="https://www.soasme.com/techshack.weekly/feeds/issues.atom.xml">RSS</a>
    <br>
    欢迎加入 <a href="https://t.me/techshack">Telegram Channel</a> ，
    <br>
    <iframe src="https://tgwidget.com/widget/count/?id=5a66b26483ba88e7118b4568" frameborder="0" scrolling="no" horizontalscrolling="no" verticalscrolling="no" width="160px" height="50px" async></iframe>
    <br>
    关注推特 <a href="https://twitter.com/techshackweekly">@techshackweekly</a>。
    <br>
    <a href="https://twitter.com/TechshackWeekly?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @TechshackWeekly</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <hr>
</div></div>
                <div><!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
    #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif;  width:250px;}
    /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
       We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="https://soasme.us17.list-manage.com/subscribe/post?u=617c1cb80ba1b0cbf828df387&amp;id=10442a8ee6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
    <label for="mce-EMAIL">Subscribe to our mailing list</label>
    <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_617c1cb80ba1b0cbf828df387_10442a8ee6" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>

<!--End mc_embed_signup--></div>
                    <div>:: <a href="https://www.soasme.com/techshack.weekly/categories.html">Categories</a></div>
                <!-- <span class="feed"><a href="">RSS</a> | <a href="">Atom</a></span> -->
            </div>
            <div class="col-lg-2"></div>
        </div>
    </div>
    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-36183732-2");
    pageTracker._trackPageview();
    } catch(err) {}</script>
</body>
</html>